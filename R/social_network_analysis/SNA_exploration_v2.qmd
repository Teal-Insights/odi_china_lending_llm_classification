---
title: "Chinese Co-Financing Network Analysis"
author: "Teal Emery"
format: 
  html:
    code-fold: true
    toc: true
    toc-depth: 3
    fig-width: 10
    fig-height: 8
    embed-resources: true
  pdf:
    toc: true
    toc-depth: 3
    fig-width: 8
    fig-height: 6
editor: visual
---

```{r setup, include=FALSE}
#| message: false

# Check for required packages and install if missing
if (!requireNamespace("tidygraph", quietly = TRUE)) {
  install.packages("tidygraph")
}
if (!requireNamespace("ggraph", quietly = TRUE)) {
  install.packages("ggraph")
}

if (!requireNamespace("patchwork", quietly = TRUE)) {
  install.packages("patchwork")
}

if (!requireNamespace("kableExtra", quietly = TRUE)) {
  install.packages("kableExtra")
}

# Load required libraries
library(tidyverse)   # For data manipulation
library(tidygraph)   # For network objects and centrality measures
library(ggraph)      # For network visualizations
library(here)        # Relative paths
library(ggrepel)     # Repelled text labels
library(igraph)      # For additional network metrics
library(patchwork)   # For combining plots
library(kableExtra)  # For nicer tables

# Set options
options(scipen = 999)  # Avoid scientific notation
set.seed(12345)        # Set seed for reproducible network layouts
```

## Introduction

This analysis explores the structure of co-financing networks in China's overseas development finance, with a particular focus on how these networks differ between conventional financing and green projects. Using social network analysis (SNA), we investigate which financial institutions play central roles in different types of project financing, and how their relative prominence changes across different sectors.

A key question we explore is: **Do green projects rely on different institutional networks compared to traditional Belt and Road financing?** Understanding these network structures provides insight into the mechanisms through which China's financial institutions balance risk management with their mandate to support green development.

## Data Loading and Preparation

We first load the prepared dataset containing transaction-level co-financing information.

```{r data-loading}
sna_data_nested <- read_rds(
  here(
    "data",
    "social_network_analysis",
    "data_for_social_network_analysis.rds"
  )
)

# Unnest the data to get all unique lender combinations
data_for_sna <- sna_data_nested |> 
  unnest(unique_lenders) |> 
  unique()

# Quick overview of the data structure
glimpse(data_for_sna)
```

The dataset contains transaction-level information with the following key variables:

- `transaction_id`: Unique identifier for each financing transaction
- `standardized_lender_name`: Harmonized names of lending institutions
- `lender_geography`: Whether the lender is Chinese or non-Chinese
- `lender_profit_orientation`: Categorized as "Profit Maximizing," "Mixed Mandate," or "Policy Driven"
- `transaction_primary_class`: Classification of transactions (e.g., "GREEN", "BROWN", "GREY")

## Network Analysis Functions

The following functions form the core of our network analysis, enabling us to construct and visualize co-financing relationships.

### Building Co-Financing Networks

```{r network-building-function}
#| code-fold: show

# ------------------------------------------------------------------------------
# Function: build_cofinancing_network
#
# Constructs a co-financing network graph from transaction data.
#
# Arguments:
#   data              - The processed dataset
#   transaction_class - (Optional) Filter to specific transaction type (e.g., "GREEN")
#   top_n             - Number of top nodes (by degree) to retain
#   min_collabs       - Minimum number of collaborations required for an edge
#
# Returns:
#   A tidygraph object with nodes (lenders) and edges (co-financing relationships)
# ------------------------------------------------------------------------------
build_cofinancing_network <- function(data, transaction_class = NULL, top_n = 50, min_collabs = 2) {
  
  # Optionally filter to a specific transaction class
  if (!is.null(transaction_class)) {
    data <- data |> filter(transaction_primary_class == transaction_class)
  }
  
  # Create edge list
  edges <- data |>
    select(transaction_id, standardized_lender_name) |>
    distinct() |>
    group_by(transaction_id) |>
    # Only consider transactions with at least 2 lenders
    filter(n() >= 2) |>
    summarise(
      pairs = list(combn(standardized_lender_name, 2, simplify = FALSE)),
      .groups = "drop"
    ) |>
    unnest(pairs) |>
    mutate(
      from = map_chr(pairs, 1),
      to   = map_chr(pairs, 2)
    ) |>
    select(from, to) |>
    # Ensure edge is undirected by sorting lender names
    mutate(
      from = pmin(from, to),
      to   = pmax(from, to)
    ) |>
    group_by(from, to) |>
    summarise(weight = n(), .groups = "drop")
  
  # Build node data
  nodes <- data |>
    distinct(standardized_lender_name, lender_geography, lender_core_type, lender_profit_orientation)
  
  # Create tidygraph object (undirected network)
  graph <- tbl_graph(nodes = nodes, edges = edges, directed = FALSE)
  
  # Compute centrality measures
  graph <- graph |>
    mutate(
      degree      = centrality_degree(),
      betweenness = centrality_betweenness(),
      closeness   = centrality_closeness()
    )
  
  # Add constraint measure
  graph_igraph <- as.igraph(graph)
  V(graph_igraph)$constraint <- constraint(graph_igraph)
  
  # Add constraint back to tidygraph object
  graph <- graph |>
    activate(nodes) |>
    mutate(constraint = V(graph_igraph)$constraint)
  
  # Filter to top_n nodes by degree
  node_data <- graph |> activate(nodes) |> as_tibble()
  top_lenders <- node_data |>
    arrange(desc(degree)) |>
    slice_head(n = top_n)
  
  graph_filtered <- graph |>
    activate(nodes) |>
    filter(standardized_lender_name %in% top_lenders$standardized_lender_name) |>
    convert(to_subgraph)
  
  # Filter edges by minimum collaborations
  graph_filtered <- graph_filtered |>
    activate(edges) |>
    filter(weight >= min_collabs) |>
    convert(to_subgraph)
  
  return(graph_filtered)
}

# Function to create a full network without top_n filtering (for quantitative analysis)
build_cofinancing_network_full <- function(data, transaction_class = NULL, min_collabs = 2) {
  
  # Optionally filter to a specific transaction class
  if (!is.null(transaction_class)) {
    data <- data |> filter(transaction_primary_class == transaction_class)
  }
  
  # Create edge list
  edges <- data |>
    select(transaction_id, standardized_lender_name) |>
    distinct() |>
    group_by(transaction_id) |>
    filter(n() >= 2) |>
    summarise(
      pairs = list(combn(standardized_lender_name, 2, simplify = FALSE)),
      .groups = "drop"
    ) |>
    unnest(pairs) |>
    mutate(
      from = map_chr(pairs, 1),
      to   = map_chr(pairs, 2)
    ) |>
    select(from, to) |>
    mutate(
      from = pmin(from, to),
      to   = pmax(from, to)
    ) |>
    group_by(from, to) |>
    summarise(weight = n(), .groups = "drop")
  
  # Build node data
  nodes <- data |>
    distinct(standardized_lender_name, lender_geography, lender_core_type, lender_profit_orientation)
  
  # Create tidygraph object
  graph <- tbl_graph(nodes = nodes, edges = edges, directed = FALSE)
  
  # Compute centrality measures including constraint
  graph_igraph <- as.igraph(graph)
  V(graph_igraph)$constraint <- constraint(graph_igraph)
  
  graph <- graph |>
    mutate(
      degree      = centrality_degree(),
      betweenness = centrality_betweenness(),
      closeness   = centrality_closeness(),
      constraint  = V(graph_igraph)$constraint
    )
  
  # Filter edges by minimum collaborations
  graph_full <- graph |>
    activate(edges) |>
    filter(weight >= min_collabs) |>
    convert(to_subgraph)
  
  return(graph_full)
}
```

### Visualizing Networks

```{r plotting-function}
#| code-fold: show

# ------------------------------------------------------------------------------
# Function: plot_network
#
# Visualizes a tidygraph network object with customized aesthetics.
#
# Node Aesthetics:
#   - Color: by lender_geography/profit orientation
#   - Shape: by lender_profit_orientation
#   - Size: by degree centrality
#
# Edge Aesthetics:
#   - Width: proportional to number of collaborations (weight)
#
# ------------------------------------------------------------------------------

plot_network <- function(graph, title = "Co-Financing Network", repel_force = 1, for_export = FALSE) {
  
  # Create a combined label for coloring
  graph <- graph |>
    activate(nodes) |>
    mutate(
      lender_color_label = if_else(
        lender_geography == "Chinese",
        "Chinese",
        paste0("Non-Chinese: ", lender_profit_orientation)
      )
    )
  
  # Define custom color and shape mappings
  color_values <- c(
    "Chinese" = "#E41A1C",  # Brighter red
    "Non-Chinese: Profit Maximizing" = "#377EB8",  # Blue
    "Non-Chinese: Mixed Mandate"     = "#984EA3",  # Purple
    "Non-Chinese: Policy Driven"     = "#4DAF4A"   # Green
  )
  
  shape_values <- c(
    "Profit Maximizing" = 16,  # circle
    "Mixed Mandate"     = 17,  # triangle
    "Policy Driven"     = 18,  # diamond
    "Uncategorized"     = 15   # square
  )
  
  # Set seed for reproducible layout
  set.seed(42)
  
  # Create the network plot with a force-directed layout
  p <- ggraph(graph, layout = "fr") +
    # Draw edges with enhanced visibility
    geom_edge_link(
      aes(width = weight, alpha = weight),
      color = "gray40", 
      lineend = "round"
    ) +
    # Draw nodes
    geom_node_point(
      aes(
        color = lender_color_label, 
        shape = lender_profit_orientation, 
        size = degree
      ),
      stroke = 0.5
    ) +
    # Add repelled text labels
    geom_node_text(
      aes(label = standardized_lender_name), 
      repel = TRUE, 
      size = 3.2,
      fontface = "bold",
      bg.color = "white",
      bg.r = 0.15,
      force = repel_force,
      max.overlaps = 30
    ) +
    # Apply manual scales
    scale_color_manual(values = color_values) +
    scale_shape_manual(values = shape_values) +
    scale_edge_width(range = c(0.5, 2.5)) +
    scale_edge_alpha(range = c(0.4, 0.9))
    
  # Conditionally add labels based on whether for export or not
  if (!for_export) {
    p <- p + 
      labs(
        title = title,
        color = "Lender Type",
        shape = "Profit Orientation",
        size = "Degree Centrality"
      )
  }
  
  # Add theme
  p <- p +
    theme_void() +
    theme(
      plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
      plot.subtitle = element_text(hjust = 0.5),
      legend.position = "right",
      legend.title = element_text(face = "bold"),
      plot.margin = margin(10, 10, 10, 10)
    )
  
  return(p)
}
```

## Composition of Co-Financed Projects

Before examining the network structure, we analyze the lender composition of co-financed projects to understand the fundamental differences between green and non-green projects.

```{r project-composition}
# Create a summary of lender composition per transaction
transaction_lender_summary <- data_for_sna |>
  group_by(
    transaction_id, 
    transaction_primary_class,
    recipient,
    recipient_region,
    commitment_year, 
    involving_multilateral
  ) |>
  summarise(
    total_lenders = n(),
    count_profit_maximizing = sum(lender_profit_orientation == "Profit Maximizing", na.rm = TRUE),
    count_mixed_mandate = sum(lender_profit_orientation == "Mixed Mandate", na.rm = TRUE),
    count_policy_driven = sum(lender_profit_orientation == "Policy Driven", na.rm = TRUE),
    pct_profit_maximizing = (count_profit_maximizing / total_lenders) * 100,
    pct_mixed_mandate = (count_mixed_mandate / total_lenders) * 100,
    pct_policy_driven = (count_policy_driven / total_lenders) * 100,
    dominant_lender_type = case_when(
      count_profit_maximizing > count_mixed_mandate &
      count_profit_maximizing > count_policy_driven ~ "Profit Maximizing",
      count_mixed_mandate > count_profit_maximizing &
      count_mixed_mandate > count_policy_driven ~ "Mixed Mandate",
      count_policy_driven > count_profit_maximizing &
      count_policy_driven > count_mixed_mandate ~ "Policy Driven",
      TRUE ~ "Mixed (No Clear Dominant)"
    ),
    .groups = "drop"
  )
```

### Non-Chinese Lender Composition Analysis

```{r non-chinese-composition}
# Filter to only non-Chinese lenders
non_chinese_lenders <- data_for_sna |>
  filter(lender_geography == "Non-Chinese")

# Create transaction-level summary
non_chinese_transaction_summary <- non_chinese_lenders |>
  group_by(
    transaction_id, 
    transaction_primary_class
  ) |>
  summarise(
    total_lenders = n(),
    count_profit_maximizing = sum(lender_profit_orientation == "Profit Maximizing", na.rm = TRUE),
    count_policy_driven = sum(lender_profit_orientation == "Policy Driven", na.rm = TRUE),
    pct_profit_maximizing = (count_profit_maximizing / total_lenders) * 100,
    pct_policy_driven = (count_policy_driven / total_lenders) * 100,
    .groups = "drop"
  )

# Create summary by project type
non_chinese_composition_summary <- non_chinese_transaction_summary |> 
  mutate(
    green_or_not = ifelse(transaction_primary_class == "GREEN", 
                         "Green Projects", "All Other Lending")
  ) |> 
  group_by(green_or_not) |> 
  summarise(
    mean_policy_driven = mean(pct_policy_driven, na.rm = TRUE),
    mean_profit_max = mean(pct_profit_maximizing, na.rm = TRUE),
    count = n()
  ) |> 
  ungroup()

# Convert to long format
non_chinese_composition_long <- non_chinese_composition_summary |>
  pivot_longer(
    cols = c("mean_policy_driven", "mean_profit_max"),
    names_to = "lender_type",
    values_to = "percentage"
  ) |>
  mutate(
    lender_type = case_when(
      lender_type == "mean_policy_driven" ~ "Policy-Driven",
      lender_type == "mean_profit_max" ~ "Profit-Maximizing"
    )
  )

# Create bar chart
ggplot(non_chinese_composition_long, 
       aes(x = green_or_not, y = percentage, fill = lender_type)) +
  geom_col(position = "dodge", width = 0.7) +
  geom_text(aes(label = paste0(round(percentage), "%")), 
            position = position_dodge(width = 0.7),
            vjust = -0.5, size = 4) +
  scale_fill_manual(values = c("Policy-Driven" = "#4DAF4A", 
                               "Profit-Maximizing" = "#377EB8")) +
  labs(
    title = "Average Composition of Non-Chinese Lenders in Co-Financed Projects",
    subtitle = "Green projects rely heavily on policy-driven institutions",
    x = "",
    y = "Average Percentage",
    fill = "Lender Type"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    panel.grid.minor = element_blank(),
    text = element_text(size = 12),
    axis.text.x = element_text(face = "bold", size = 12)
  ) +
  annotate("segment", x = "Green Projects", y = 65, xend = "Green Projects", yend = 72,
           arrow = arrow(length = unit(0.3, "cm")), color = "darkgreen") +
  annotate("text", x = "Green Projects", y = 78,
           label = "Non-Chinese policy banks dominate\ngreen project co-financing", 
           size = 4, color = "darkgreen", hjust = 0.5)

# Export data for designer
write_csv(
  non_chinese_composition_long,
  here("R", "social_network_analysis", "output for designer", "non_chinese_composition.csv")
)

# Export the average composition data of non-Chinese lenders for green vs other projects
write_csv(
  non_chinese_composition_summary,
  here("R", "social_network_analysis", "output for designer", "non_chinese_composition_summary.csv")
)
```

This analysis reveals a stark contrast in the composition of non-Chinese lenders between green and conventional projects:

1. **Green projects** are heavily dominated by policy-driven institutions, which make up approximately 70% of non-Chinese co-financiers.

2. **Conventional projects** show a much more balanced distribution, with profit-maximizing commercial banks playing a more significant role.

This fundamental difference in lender composition suggests that green financing in China's overseas development portfolio operates through distinctly different institutional channels than conventional financing. The policy-driven nature of green co-financing has important implications for scaling such investments, as it indicates limited commercial bank participation to date.

## Overall Co-Financing Network Analysis

We now examine the overall co-financing network, which includes all transaction types.

```{r overall-network}
# Build the overall network visualization
network_overall <- build_cofinancing_network(
  data_for_sna,
  top_n = 20,
  min_collabs = 1
)

# Visualize the overall network for the document
p_overall <- plot_network(
  network_overall, 
  title = "Overall Co-Financing Network: Top 20 Institutions"
)

# Display the plot
print(p_overall)

# Generate version for export (without title)
p_overall_export <- plot_network(
  network_overall, 
  for_export = TRUE
)

# Export to the designer folder
ggsave(
  filename = here("R", "social_network_analysis", "output for designer", "overall_network.png"),
  plot = p_overall_export,
  width = 12, height = 10, dpi = 300
)
```

In the overall co-financing network, we observe:

1. **Dense Commercial Core**: The network has a densely interconnected structure dominated by commercial banks, both Chinese and international. Bank of China stands out with the highest degree centrality (386) and extraordinarily high betweenness (26,999), indicating its critical role in facilitating connections across the network.

2. **Japanese Bank Cluster**: Japanese banks (Sumitomo Mitsui, Mitsubishi UFJ, Mizuho) form a particularly strong cluster, with Sumitomo Mitsui ranking second in degree centrality (367).

3. **Low Constraint Values**: Top banks in this network have consistently low constraint scores (around 0.05), indicating diverse connections across multiple financing ecosystems rather than being confined to specific clusters.

4. **Uniform Closeness**: All top institutions have similar closeness centrality (approximately 0.001), suggesting a relatively even structure where most major institutions can reach others through similar path lengths.

5. **Limited Policy Bank Presence**: While China Development Bank appears in the network, most policy-driven institutions are noticeably absent from the core of the overall network, reflecting their limited role in general co-financing activities.

### Top Lenders in Overall Network

```{r overall-top-lenders}
# Extract centrality measures from the overall network
top_lenders_overall <- network_overall |>
  activate(nodes) |>
  as_tibble() |>
  select(standardized_lender_name, lender_geography, lender_profit_orientation, 
         degree, betweenness, closeness, constraint) |>
  arrange(desc(degree))

# Display the top 10 lenders by degree centrality
top_lenders_overall |>
  slice_head(n = 10) |>
  kable(
    caption = "Top 10 Lenders by Degree Centrality (Overall Network)",
    col.names = c("Lender", "Geography", "Profit Orientation", 
                 "Degree", "Betweenness", "Closeness", "Constraint"),
    digits = c(0, 0, 0, 0, 2, 3, 3)
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Export data for designer
write_csv(
  top_lenders_overall,
  here("R", "social_network_analysis", "output for designer", "overall_top_lenders.csv")
)
```

The centrality metrics for the overall network reveal:

- **Chinese Mixed-Mandate Dominance**: Bank of China and ICBC both rank in the top 5, with exceptionally high betweenness centrality (26,999 and 20,923 respectively), highlighting their role as bridges between different parts of the financing ecosystem.

- **International Commercial Integration**: The network is dominated by major international commercial banks (7 of the top 10), with particularly strong representation from Asian institutions (3 Japanese banks).

- **Low Constraint Across the Board**: All top 10 institutions have constraint values between 0.049 and 0.057, indicating they all maintain diverse, non-redundant connections across the financing ecosystem.

- **Standard Chartered's Position**: Standard Chartered ranks 4th in degree centrality and has the lowest constraint value (0.049), reflecting its strategic position connecting multiple financing networks, particularly in emerging markets.

## Green Co-Financing Network Analysis

Now we examine the network structure specifically for green projects.

```{r green-network}
# Build the green network
network_green <- build_cofinancing_network(
  data_for_sna, 
  transaction_class = "GREEN", 
  top_n = 20, 
  min_collabs = 1
)

# Visualize the green network
p_green <- plot_network(
  network_green, 
  title = "Green Projects Co-Financing Network: Top 20 Institutions",
  repel_force = 1.2
)

# Display the plot
print(p_green)

# Generate version for export (without title)
p_green_export <- plot_network(
  network_green, 
  repel_force = 1.2,
  for_export = TRUE
)

# Export to the designer folder
ggsave(
  filename = here("R", "social_network_analysis", "output for designer", "green_network.png"),
  plot = p_green_export,
  width = 12, height = 10, dpi = 300
)
```

The green co-financing network displays striking differences from the overall network:

1. **Bifurcated Structure**: The network clearly splits into two distinct clusters - a policy-driven cluster dominated by development banks and a smaller commercial cluster.

2. **Changed Leadership Dynamics**: Societe Generale tops the degree centrality ranking (50), while ICBC maintains an extremely high betweenness (2211.87) despite having slightly lower degree (48), confirming its crucial bridging role between policy and commercial clusters.

3. **Policy Bank Emergence**: The network shows much stronger representation of policy-driven institutions, with KfW (34), International Finance Corporation (33), and African Development Bank (29) all appearing in the top 10 - a dramatic difference from the overall network.

4. **Higher Constraint Values**: Constraint values are generally higher in the green network (ranging from 0.068 to 0.121 for top 10), indicating more clustered, less diverse connections compared to the overall network.

5. **Chinese Banks as Strategic Bridges**: ICBC, Bank of China, and China Eximbank all maintain important positions, serving as crucial bridges between the policy and commercial clusters with some of the highest betweenness centrality scores.

### Top Lenders in Green Network

```{r green-top-lenders}
# Extract centrality measures from the green network
top_lenders_green <- network_green |>
  activate(nodes) |>
  as_tibble() |>
  select(standardized_lender_name, lender_geography, lender_profit_orientation, 
         degree, betweenness, closeness, constraint) |>
  arrange(desc(degree))

# Display the top 10 lenders by degree centrality
top_lenders_green |>
  slice_head(n = 10) |>
  kable(
    caption = "Top 10 Lenders by Degree Centrality (Green Network)",
    col.names = c("Lender", "Geography", "Profit Orientation", 
                 "Degree", "Betweenness", "Closeness", "Constraint"),
    digits = c(0, 0, 0, 0, 2, 3, 3)
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Export data for designer
write_csv(
  top_lenders_green,
  here("R", "social_network_analysis", "output for designer", "green_top_lenders.csv")
)
```

The centrality metrics in the green network reveal several key patterns:

- **Societe Generale's Prominence**: This French commercial bank leads in degree centrality (50), suggesting broad participation across green projects, yet its betweenness (1250.22) is significantly lower than ICBC's, indicating less of a bridging role.

- **ICBC's Critical Bridging Function**: ICBC has the second-highest degree (48) but over 1.7 times the betweenness of Societe Generale (2211.87), coupled with a relatively low constraint (0.068), confirming its unique position connecting otherwise separate financing clusters.

- **Public Development Banks' Emergence**: KfW (34), IFC (33), and African Development Bank (29) all appear in the top 10, with significant betweenness scores, highlighting their importance in the green financing ecosystem.

- **Export-Import Bank of China's Role**: China Eximbank ranks 9th in degree (29) but has the third-highest betweenness (1346.71), indicating its specialized bridging role, particularly in connecting Chinese commercial banks with policy-oriented institutions.

- **Higher Network Integration**: Closeness centrality values are approximately 3-4 times higher than in the overall network, suggesting the green financing network has shorter paths between institutions despite its bifurcated structure.

## Normalized Degree Centrality Analysis

To better understand the relative importance of different types of institutions in the green network, we analyze normalized degree centrality by institution type:

```{r normalized-centrality}
# Build full networks for quantitative comparison
network_overall_full <- build_cofinancing_network_full(data_for_sna, min_collabs = 1)
network_green_full <- build_cofinancing_network_full(data_for_sna, transaction_class = "GREEN", min_collabs = 1)

# Add normalized centrality measures in the green network
network_green_full <- network_green_full |>
  activate(nodes) |>
  mutate(
    norm_degree = degree / (n() - 1),
    norm_betweenness = betweenness / max(betweenness, na.rm = TRUE)
  )

# Extract centrality data for green network
centrality_green_full <- network_green_full |>
  activate(nodes) |>
  as_tibble() |>
  select(standardized_lender_name, lender_geography, lender_profit_orientation, 
         degree, betweenness, closeness, constraint, norm_degree, norm_betweenness)

# Prepare data for visualization focusing on normalized degree in green network
centrality_plot_data <- centrality_green_full |>
  group_by(lender_geography, lender_profit_orientation) |>
  summarise(
    avg_norm_degree = mean(norm_degree, na.rm = TRUE),
    count = n(),
    .groups = "drop"
  ) |>
  mutate(lender_category = paste(lender_geography, lender_profit_orientation, sep = ": "))

# Create a bar chart of normalized degree by lender type
p_centrality <- ggplot(centrality_plot_data, 
       aes(x = reorder(lender_category, avg_norm_degree), 
           y = avg_norm_degree, 
           fill = lender_geography)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Average Normalized Degree Centrality in Green Co-Financing Network",
    subtitle = "Higher values indicate more central position in the network",
    x = "",
    y = "Average Normalized Degree",
    fill = "Geography"
  ) +
  scale_fill_manual(values = c("Chinese" = "#E41A1C", "Non-Chinese" = "#377EB8")) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(face = "bold"),
    axis.text.y = element_text(face = "bold")
  )

print(p_centrality)

# Create version for export
p_centrality_export <- ggplot(centrality_plot_data, 
       aes(x = reorder(lender_category, avg_norm_degree), 
           y = avg_norm_degree, 
           fill = lender_geography)) +
  geom_col() +
  coord_flip() +
  labs(
    x = "",
    y = "Average Normalized Degree"
  ) +
  scale_fill_manual(values = c("Chinese" = "#E41A1C", "Non-Chinese" = "#377EB8")) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    axis.text.y = element_text(face = "bold")
  )

# Export for designer
ggsave(
  filename = here("R", "social_network_analysis", "output for designer", "normalized_degree.png"),
  plot = p_centrality_export,
  width = 10, height = 6, dpi = 300
)
```

The normalized degree centrality analysis reveals a clear hierarchy in the green co-financing network:

1. **Chinese Mixed-Mandate Banks**: These institutions (primarily ICBC and BOC) have by far the highest normalized degree centrality (0.125), confirming their crucial role in connecting different parts of the network.

2. **Non-Chinese Profit-Maximizing Banks**: Despite their reduced role compared to the overall network, these institutions still maintain high connectivity (0.100 normalized degree), particularly focused within their commercial cluster.

3. **Policy-Driven Institutions**: Both Chinese and non-Chinese policy banks show moderate normalized degree centrality (0.075 and 0.070 respectively), reflecting their participation in a smaller set of focused relationships.

4. **Chinese Profit-Maximizing Banks**: These have the lowest normalized degree (0.040), indicating more peripheral roles in the green financing network.

This hierarchy demonstrates how Chinese mixed-mandate banks serve as the critical connective tissue in the green financing network, bridging between the otherwise separate policy and commercial clusters.

## Key Institution Analysis

### Standard Bank Group Analysis

Standard Bank Group (SBG) is a particularly interesting case in our network analysis, representing a unique South African financial institution with strong ties to Chinese lenders.

```{r standard-bank-analysis}
# Analyze Standard Bank's position
standard_bank_data <- data_for_sna |>
  filter(grepl("Standard Bank", standardized_lender_name))

# Get Standard Bank's centrality metrics in the overall network
standard_bank_metrics_overall <- network_overall_full |>
  activate(nodes) |>
  as_tibble() |>
  filter(grepl("Standard Bank", standardized_lender_name))

# Look at Standard Bank's connections
standard_bank_partners <- data_for_sna |>
  filter(transaction_id %in% standard_bank_data$transaction_id) |>
  filter(!grepl("Standard Bank", standardized_lender_name)) |>
  count(standardized_lender_name, lender_geography, lender_profit_orientation, sort = TRUE)

# Check if Standard Bank appears in green transactions
standard_bank_green <- data_for_sna |>
  filter(grepl("Standard Bank", standardized_lender_name), 
         transaction_primary_class == "GREEN")

# Display Standard Bank's metrics
standard_bank_metrics_overall |>
  select(standardized_lender_name, degree, betweenness, closeness, constraint) |>
  kable(
    caption = "Standard Bank Group Network Metrics (Overall Network)",
    digits = c(0, 0, 2, 3, 3)
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Display Standard Bank's top partners
standard_bank_partners |>
  slice_head(n = 10) |>
  kable(
    caption = "Standard Bank Group's Top Co-Financing Partners",
    col.names = c("Partner Institution", "Geography", "Profit Orientation", "Number of Co-Financed Transactions")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Export data for designer
write_csv(
  standard_bank_metrics_overall |> select(standardized_lender_name, degree, betweenness, closeness, constraint),
  here("R", "social_network_analysis", "output for designer", "standard_bank_metrics.csv")
)

write_csv(
  standard_bank_partners |> slice_head(n = 10),
  here("R", "social_network_analysis", "output for designer", "standard_bank_partners.csv")
)
```

**Key Findings on Standard Bank Group:**

1. **Strategic Position**: Standard Bank has a substantial presence in the overall network with 138 connections and a betweenness of 927.52, placing it as the only African bank with significant centrality in the Chinese co-financing ecosystem.

2. **ICBC Partnership**: The data confirms Standard Bank's strategic relationship with ICBC, which is its most frequent partner (29 co-financed transactions). This aligns with their known institutional connection, as ICBC holds a 20% stake in Standard Bank and they operate a joint venture (ICBC Standard Bank).

3. **Commercial Focus**: Standard Bank's co-financing relationships are overwhelmingly with profit-maximizing commercial banks, with all top 5 partners being profit-maximizing institutions (ICBC being the only mixed-mandate exception).

4. **Moderate Constraint (0.058)**: Standard Bank's constraint score is relatively low, indicating it maintains diverse, non-redundant connections across different financing ecosystems.

5. **Green Finance Potential**: Our dataset doesn't show Standard Bank in green transactions, but the bank is known to be active in South Africa's Renewable Energy Independent Power Producer Procurement (REIPPP) program. Its established relationship with ICBC, which is a central player in the green network, positions it as a potential gateway for expanding Chinese green finance in Africa.

These findings suggest that the ICBC-Standard Bank partnership represents an important model for how regional banks can facilitate Chinese participation in financing in the Global South. While not yet fully realized in green financing, this partnership could be leveraged to expand green co-financing in Africa, where it's most needed.

### People's Bank of China Analysis

The People's Bank of China (PBOC) presents another intriguing case: a significant funder of green projects that has relatively low visibility in the network analysis.

```{r pboc-analysis}
# Analyze PBOC's transactions
pboc_data <- data_for_sna |>
  filter(standardized_lender_name == "People's Bank of China")

# Count by transaction class
pboc_transaction_count <- pboc_data |>
  count(transaction_primary_class)

# Get PBOC's co-financing partners
pboc_partners <- data_for_sna |>
  filter(transaction_id %in% pboc_data$transaction_id) |>
  filter(standardized_lender_name != "People's Bank of China") |>
  count(standardized_lender_name, lender_geography, lender_profit_orientation, sort = TRUE)

# Get PBOC's network position in green network (if it exists)
pboc_green_metrics <- network_green_full |>
  activate(nodes) |>
  as_tibble() |>
  filter(standardized_lender_name == "People's Bank of China")

# Display PBOC's transaction counts
pboc_transaction_count |>
  kable(
    caption = "PBOC Transactions by Project Class",
    col.names = c("Project Class", "Number of Transactions")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Display PBOC's metrics in green network if available
if(nrow(pboc_green_metrics) > 0) {
  pboc_green_metrics |>
    select(standardized_lender_name, degree, betweenness, closeness, constraint) |>
    kable(
      caption = "PBOC Network Metrics (Green Network)",
      digits = c(0, 0, 2, 3, 3)
    ) |>
    kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
}

# Display PBOC's top partners
pboc_partners |>
  slice_head(n = 10) |>
  kable(
    caption = "PBOC's Top Co-Financing Partners",
    col.names = c("Partner Institution", "Geography", "Profit Orientation", "Number of Co-Financed Transactions")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Ensure PBOC data is saved
write_csv(
  pboc_transaction_count,
  here("R", "social_network_analysis", "output for designer", "pboc_transaction_count.csv")
)

write_csv(
  pboc_green_metrics |> select(standardized_lender_name, degree, betweenness, closeness, constraint, norm_degree, norm_betweenness),
  here("R", "social_network_analysis", "output for designer", "pboc_network_metrics.csv")
)

write_csv(
  pboc_partners |> slice_head(n = 10),
  here("R", "social_network_analysis", "output for designer", "pboc_top_partners.csv")
)
```

**Key Findings on People's Bank of China:**

1. **High Green Transaction Count**: PBOC appears in 20 green transactions, representing a substantial commitment to green financing, along with 13 "grey" transactions and 62 "neutral" transactions.

2. **Moderate Network Centrality**: Despite its significant transaction volume, PBOC has moderate network centrality metrics in the green network, with a degree of 12 and betweenness of 93.32.

3. **Focused Co-Financing Strategy**: PBOC's co-financing is highly concentrated with a small set of multilateral development banks:
   - Inter-American Development Bank (65 transactions)
   - African Development Bank (30 transactions)
   - Canadian Climate Fund for the Americas (7 transactions)
   - International Finance Corporation (6 transactions)

4. **Moderate Constraint (0.181)**: PBOC's constraint score is higher than commercial banks but lower than most policy banks, reflecting its position between highly constrained policy banks and less constrained commercial banks.

5. **Fund-Based Approach**: Rather than participating directly in diverse co-financing arrangements, PBOC establishes dedicated funds administered by MDBs, such as the China Co-financing Fund for Latin America at IDB and the Africa Growing Together Fund at AfDB.

This "high count, low centrality" pattern reflects PBOC's strategic choice to deploy capital through trusted multilateral intermediaries rather than directly participating in diverse financing arrangements. While this focuses its impact, it may limit its broader influence across the green financing ecosystem. The data suggests PBOC has established a concentrated but effective model for deploying green finance through multilateral channels.

## Comparative Network Analysis

To systematically compare the overall and green networks, we calculate comprehensive network metrics for both and examine differences in centrality by lender type.

```{r centrality-comparison}
# Extract centrality data from overall network
centrality_overall_full <- network_overall_full |>
  activate(nodes) |>
  as_tibble() |>
  select(standardized_lender_name, lender_geography, lender_profit_orientation, 
         degree, betweenness, closeness, constraint)

# Summarize by profit orientation and geography for both networks
avg_centrality_overall <- centrality_overall_full |>
  group_by(lender_profit_orientation, lender_geography) |>
  summarise(
    avg_degree = mean(degree, na.rm = TRUE),
    avg_betweenness = mean(betweenness, na.rm = TRUE),
    avg_closeness = mean(closeness, na.rm = TRUE),
    avg_constraint = mean(constraint, na.rm = TRUE),
    count_overall = n(),
    .groups = "drop"
  )

avg_centrality_green <- centrality_green_full |>
  group_by(lender_profit_orientation, lender_geography) |>
  summarise(
    avg_degree = mean(degree, na.rm = TRUE),
    avg_betweenness = mean(betweenness, na.rm = TRUE),
    avg_closeness = mean(closeness, na.rm = TRUE),
    avg_constraint = mean(constraint, na.rm = TRUE),
    avg_norm_degree = mean(norm_degree, na.rm = TRUE),
    avg_norm_betweenness = mean(norm_betweenness, na.rm = TRUE),
    count_green = n(),
    .groups = "drop"
  )

# Merge for comparison
avg_centrality_comparison <- avg_centrality_overall |>
  left_join(avg_centrality_green, by = c("lender_profit_orientation", "lender_geography"), 
            suffix = c("_overall", "_green"))

# Create a focused comparison table
centrality_comparison_table <- avg_centrality_comparison |>
  select(
    lender_profit_orientation,
    lender_geography,
    count_overall,
    count_green,
    avg_degree_overall,
    avg_degree_green,
    avg_constraint_overall,
    avg_constraint_green
  ) |>
  rename(
    "Profit Orientation" = lender_profit_orientation,
    "Geography" = lender_geography,
    "Count (Overall)" = count_overall,
    "Count (Green)" = count_green,
    "Avg Degree (Overall)" = avg_degree_overall,
    "Avg Degree (Green)" = avg_degree_green,
    "Avg Constraint (Overall)" = avg_constraint_overall,
    "Avg Constraint (Green)" = avg_constraint_green
  )

# Display the comparison table
centrality_comparison_table |>
  kable(
    caption = "Network Centrality Comparison by Lender Type",
    digits = c(0, 0, 0, 0, 1, 1, 3, 3)
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Export data for designer
write_csv(
  centrality_comparison_table,
  here("R", "social_network_analysis", "output for designer", "centrality_comparison.csv")
)
```

The comparative analysis reveals several striking patterns:

1. **Dramatic Shift in Non-Chinese Profit-Maximizing Banks**: These institutions show the most dramatic change between networks, with average degree plummeting from 46.1 in the overall network to just 12.7 in the green network. This indicates a significantly reduced role in green financing despite their dominance in overall financing.

2. **Resilient Chinese Mixed-Mandate Banks**: These institutions maintain relatively high average degree in both networks (55.3 overall, 16.9 green) and show the lowest constraint in the green network (0.196), confirming their unique bridging position.

3. **Emerging Role of Policy-Driven Institutions**: Non-Chinese policy banks show a remarkable increase in representation, growing from 23 institutions in the overall network to 66 in the green network, though their average degree remains modest (9.7), indicating many participate in a limited number of transactions.

4. **Higher Constraint Across Categories**: Almost all lender types show higher constraint in the green network than in the overall network, indicating a more clustered, less integrated green financing ecosystem.

5. **Chinese Policy Banks' Transformation**: These institutions show a major change in constraint, rising from 0.585 in the overall network to 0.424 in the green network, suggesting they operate more as connectors in the green space despite their still relatively clustered connections.

These patterns confirm the bifurcated nature of the green financing network, with policy-driven institutions playing a much more prominent role but mainly operating within their own clusters, connected to the commercial world primarily through Chinese mixed-mandate banks.

### Rank Changes Between Networks

We compare how institutions' centrality rankings change between the overall and green networks.

```{r rank-comparison}
# Rank lenders by degree in each network
rank_overall <- centrality_overall_full |>
  arrange(desc(degree)) |>
  mutate(rank_overall = row_number()) |>
  select(standardized_lender_name, rank_overall)

rank_green <- centrality_green_full |>
  arrange(desc(degree)) |>
  mutate(rank_green = row_number()) |>
  select(standardized_lender_name, rank_green)

# Join rankings and calculate change
rank_comparison <- rank_overall |>
  inner_join(rank_green, by = "standardized_lender_name") |>
  mutate(
    rank_change = rank_overall - rank_green,
    abs_change = abs(rank_change)
  ) |>
  arrange(desc(abs_change))

# Display institutions with major rank changes
rank_comparison |>
  filter(abs_change >= 10) |>  # Filter to major changes
  slice_head(n = 10) |>
  kable(
    caption = "Major Rank Changes Between Overall and Green Networks",
    col.names = c("Institution", "Overall Rank", "Green Rank", "Rank Change", "Absolute Change")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) |>
  row_spec(which(rank_comparison$rank_change[rank_comparison$abs_change >= 10][1:10] > 0), 
           background = "#ffdddd") |>  # Worse rank in green network
  row_spec(which(rank_comparison$rank_change[rank_comparison$abs_change >= 10][1:10] < 0), 
           background = "#ddffdd")     # Better rank in green network

# Export for designer
write_csv(
  rank_comparison |> filter(abs_change >= 10) |> slice_head(n = 10),
  here("R", "social_network_analysis", "output for designer", "rank_changes.csv")
)
```

The rank comparison reveals dramatic changes in institutional prominence between networks:

1. **Massive Rank Improvements**: Several government and policy institutions show extraordinary improvements in ranking, jumping hundreds of places. For example, "Unspecified Chinese Government Institution" leaps 592 positions, while the People's Bank of China rises 583 places.

2. **Government-Led Green Financing**: Government agencies dominate the list of institutions with improved rankings, including Norway's government (+582) and China's Ministry of Commerce (+581), indicating the policy-driven nature of green financing.

3. **Regional Development Banks Emerge**: The Caribbean Development Bank jumps 562 positions, highlighting the growing role of regional development banks in green financing.

4. **Specialized European Institutions**: Spain's Institute of Official Credit rises 538 positions, showing the importance of European public finance institutions in green projects.

5. **Regional Banks in Green Finance**: Several regional commercial banks like Hatton National Bank and Kasikornbank see dramatic improvements (+572 each), suggesting local financial institutions play important roles in certain green projects.

These massive rank changes further underscore how the green financing ecosystem operates through fundamentally different channels than conventional financing, with policy-driven and regional institutions playing outsized roles.

## Co-Financing by Project Type

Finally, we examine the extent of co-financing across different green project subtypes.

```{r cofinancing-by-project-type}
# Load additional dataset with project type information
gcdf_data <- read_rds(
  here(
    "data",
    "transaction_classification",
    "gcdf_w_green_classifications.rds"
  )
)

# Analyze green projects by type and co-financing status
green_projects_summary <- gcdf_data |>
  filter(primary_class == "GREEN") |>
  group_by(project_type, co_financed) |> 
  summarize(
    amount_bn = sum(amount_constant_usd_2021, na.rm = TRUE) * 1e-9,
    project_n = n(),
    .groups = "drop"
  ) |> 
  group_by(project_type) |> 
  mutate(
    category_usd_pct = amount_bn / sum(amount_bn, na.rm = TRUE) * 100,
    category_sum_bn = sum(amount_bn, na.rm = TRUE)
  ) |> 
  ungroup() |> 
  filter(!is.na(category_usd_pct)) |> 
  pivot_wider(
    names_from = co_financed,
    values_from = category_usd_pct,
    names_prefix = "pct_",
    values_fill = 0
  ) |> 
  arrange(desc(category_sum_bn))

# Display the summary
green_projects_summary |>
  mutate(
    total_bn = round(category_sum_bn, 1),
    pct_No = round(pct_No, 1),
    pct_Yes = round(pct_Yes, 1)
  ) |>
  rename(
    "Project Type" = project_type,
    "Total ($ Billion)" = total_bn,
    "% Not Co-Financed" = pct_No,
    "% Co-Financed" = pct_Yes
  ) |>
  kable(
    caption = "Co-Financing Percentage by Green Project Type"
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

# Create categorical version with discrete color categories
green_projects_summary_cat <- green_projects_summary |>
  mutate(
    cofinance_category = cut(
      pct_Yes, 
      breaks = c(0, 25, 50, 75, 100),
      labels = c("0-25%", "25-50%", "50-75%", "75-100%"),
      include.lowest = TRUE
    )
  )

# Create categorical version of the chart
p_project_types_categorical <- green_projects_summary_cat |>
  ggplot(
    aes(x = reorder(project_type, category_sum_bn), y = category_sum_bn, fill = cofinance_category)
  ) +
  geom_col() +
  coord_flip() +
  scale_fill_brewer(palette = "Blues", direction = 1) +
  labs(
    title = "Green Project Financing by Type",
    subtitle = "Color shows percentage that is co-financed",
    x = "",
    y = "Total Financing ($ Billion)",
    fill = "% Co-Financed"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold"),
    axis.text.y = element_text(face = "bold")
  )

print(p_project_types_categorical)

# Create export version without title
p_project_types_export <- green_projects_summary_cat |>
  ggplot(
    aes(x = reorder(project_type, category_sum_bn), y = category_sum_bn, fill = cofinance_category)
  ) +
  geom_col() +
  coord_flip() +
  scale_fill_brewer(palette = "Blues", direction = 1) +
  labs(
    x = "",
    y = "Total Financing ($ Billion)",
    fill = "% Co-Financed"
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_text(face = "bold")
  )

# Export categorical version
ggsave(
  filename = here("R", "social_network_analysis", "output for designer", "project_types_categorical.png"),
  plot = p_project_types_export,
  width = 10, height = 6, dpi = 300
)

# Export data
write_csv(
  green_projects_summary,
  here("R", "social_network_analysis", "output for designer", "green_projects_summary.csv")
)
```

The analysis of co-financing by project type reveals several important patterns:

1. **Hydropower Dominance**: Hydropower projects account for the vast majority of green financing volume (approximately $61 billion) and show a substantial level of co-financing (50-75% of total volume).

2. **Nuclear Power's Bilateral Nature**: The second-largest category ($10.4 billion) is overwhelmingly dominated by non-co-financed projects (over 95%), suggesting these are primarily bilateral arrangements between China and recipient countries.

3. **Limited Scale of New Renewables**: Solar, wind, and other non-hydro renewables collectively account for less than $5 billion in financing, highlighting the still-limited scale of these technologies in China's overseas green portfolio.

4. **Varying Co-Financing Patterns**: Co-financing percentages vary dramatically across project types:
   - Hydropower: 50-75% co-financed
   - Nuclear: 0-25% co-financed
   - Solar: 25-50% co-financed
   - Wind: 25-50% co-financed
   - Green Transportation: 25-50% co-financed

5. **Long Tail of Small Projects**: Beyond the top 5 categories, there is a long tail of smaller project types (under $1 billion each), many of which show varying degrees of co-financing but represent a tiny fraction of the overall portfolio.

This breakdown highlights both the concentrated nature of China's green financing portfolio, dominated by traditional large hydro and nuclear projects, and the role of co-financing in different technology sectors. The newer renewable technologies, despite growing interest, remain a small fraction of the overall green portfolio by value.

## Understanding Centrality Measures

To interpret our network analysis, it's important to understand the centrality measures used:

1. **Degree Centrality**
   - **What it means**: The number of direct connections an institution has to others. High-degree institutions collaborate with many partners.
   - **Policy implication**: Institutions with high degree centrality are key coordinators that bring together multiple financing partners.
   - **Example**: Bank of China has the highest degree in the overall network (386), indicating its extensive collaboration across the financing ecosystem.

2. **Betweenness Centrality**
   - **What it means**: How often an institution serves as a bridge between others that wouldn't otherwise be connected.
   - **Policy implication**: High-betweenness institutions connect different financing ecosystems that would otherwise remain separate.
   - **Example**: ICBC has extremely high betweenness (2211.87) in the green network, indicating its crucial role connecting the policy and commercial clusters.

3. **Constraint**
   - **What it means**: Whether an institution's partners are also connected to each other (high constraint) or not (low constraint).
   - **Policy implication**: Low-constraint institutions have diverse, non-redundant connections and can leverage relationships across different financing ecosystems.
   - **Example**: Chinese Mixed-Mandate banks have the lowest constraint in the green network (0.196), confirming their unique bridging position, while Policy-Driven institutions have much higher constraint (0.424 for Chinese, 0.392 for non-Chinese), showing they tend to finance together in tight clusters.

4. **Closeness Centrality**
   - **What it means**: How easily an institution can reach all others in the network (the inverse of the average shortest path).
   - **Policy implication**: High-closeness institutions can efficiently disseminate information or practices across the network.
   - **Example**: Closeness values are generally low in the overall network (around 0.001) but higher in the green network (around 0.004), suggesting the green network, despite being bifurcated, has shorter paths between institutions.

5. **Normalized Degree**
   - **What it means**: Degree centrality divided by the maximum possible connections, allowing comparison across networks of different sizes.
   - **Policy implication**: Helps identify disproportionately central institutions regardless of network size.
   - **Example**: Chinese Mixed-Mandate banks have the highest normalized degree (0.125) in the green network, highlighting their outsized importance relative to network size.

These metrics together provide a comprehensive view of how different types of institutions structure their relationships and influence the overall financing ecosystem. The dramatic differences in these metrics between networks confirm the fundamentally different structure of green financing compared to conventional financing.

## Policy Implications

Our network analysis reveals several important findings with significant policy implications:

1. **Bifurcated Financing Ecosystems**: Green projects rely on fundamentally different institutional networks than traditional Belt and Road financing. The green financing network is dominated by policy-driven institutions, with much less involvement from profit-maximizing commercial lenders. This bifurcation suggests a market failure in green financing that policy interventions could address.

2. **Chinese Commercial Banks as Critical Bridges**: Chinese state-owned commercial banks like ICBC and Bank of China play a unique "bridging" role between policy-driven and commercial lending networks. Their low constraint scores (0.196) and high betweenness centrality indicate they connect financing ecosystems that would otherwise remain separate. This position gives them substantial leverage to mobilize commercial capital toward green investments.

3. **PBOC's Concentrated Multilateral Strategy**: The People's Bank of China demonstrates a distinctive approach to green financing by concentrating its activities through a small number of multilateral partners rather than participating broadly across the network. This "high count, low centrality" pattern suggests PBOC is effectively using multilateral institutions as trusted intermediaries, potentially reducing transaction costs but limiting its broader network influence.

4. **Regional Bank Potential**: Standard Bank's strategic relationship with ICBC illustrates the potential role of regional banks in facilitating Chinese green finance in the Global South. Despite Standard Bank's absence from green financing in our dataset, its position as the most prominent African bank in the overall network and its established relationship with ICBC suggest it could serve as an important gateway for expanding green co-financing in Africa.

5. **Hydropower Co-Financing Success**: The relatively high rate of co-financing in hydropower projects (50-75%) compared to other green technologies suggests that Chinese financiers have developed effective models for risk-sharing in this sector. These models could potentially be adapted and applied to newer renewable technologies to increase their scale.

6. **Limited Commercial Participation in Renewables**: The lower co-financing rates and small overall volume for solar and wind projects highlight untapped potential for commercial lender participation in these technologies. This represents a significant opportunity for scaling up these investments through targeted risk-sharing mechanisms.

For Chinese policymakers and development banks, these findings suggest several strategic opportunities:

- Leverage the bridging position of state-owned commercial banks to mobilize more commercial capital for green investments
- Consider replenishing and expanding multilateral co-financing funds that have proven effective vehicles for green project financing
- Develop more strategic partnerships with regional banks to enhance local knowledge and project pipeline development
- Explore blended finance approaches that reduce risk for commercial partners in green projects, particularly in newer renewable technologies
- Apply successful co-financing models from hydropower to other green technologies

## Conclusion

This network analysis provides robust evidence that China's green overseas financing relies on fundamentally different institutional networks than traditional Belt and Road sectors. The stark contrast between the dense, commercially-oriented overall network and the bifurcated, policy-driven green network highlights both challenges and opportunities for scaling up green financing.

The dominance of policy-driven institutions in green co-financing suggests that market forces alone have been insufficient to drive the green transition in overseas finance. However, the strategic bridge position of Chinese commercial banks offers a potential pathway to channel more commercial resources toward green projects, if properly leveraged.

As China balances financial risk management with its mandates to support green overseas investments, understanding these network dynamics can inform more effective strategies for mobilizing diverse sources of capital for the global green transition.

Our analysis demonstrates that successful green financing is not merely about the amount of capital deployed, but about the structure of institutional relationships that facilitate it. By strengthening the connections between policy and commercial financing ecosystems, China has the opportunity to substantially increase the scale and impact of its green overseas investments.
